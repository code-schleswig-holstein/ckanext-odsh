{% ckan_extends %}

{% block toolbar %}
{{ super() }}
{% snippet "snippets/search_box.html"%}
{% endblock %}

{% block page_primary_action %}
{% endblock %}

{% block package_search_results_list %}
{{ h.snippet('snippets/package_list.html', packages=c.page.items) }}
{% endblock %}


##
## tools on left side, ie filter
{% block secondary_content %}
{% snippet "spatial/snippets/spatial_query.html",
default_extent="{ \"type\": \"Polygon\", \"coordinates\": [[[7.6574,53.1632],[11.8322,53.1632],[11.8322,55.1066],
[7.6574,55.1066],[7.6574,53.1632]]] }"%}
<div class="filters">
  <div class="container-fluid filter-reset">
    <div class="filter-reset-label"><span>Filter:</span></div>
    <div class="filter-reset-box"><a href="{{c.remove_field(c.fields_grouped)}}">zur√ºcksetzen</a></button></div>
  </div>

  <div>
    {% for facet in c.facet_titles %}
    {{ h.snippet('snippets/facet_list.html', title=c.facet_titles[facet], name=facet) }}
    {% endfor %}
  </div>

  {% block datereange_search %}
  {% resource 'odsh/odsh_rangesearch.js' %}
  {% set has_range_filter = request.params.get('ext_startdate') or request.params.get('ext_enddate') %}
<section class="module module-narrow module-shallow">
  <nav>
    <div class="nav-title">{{_('timerange')}}</div>
    <div class="rangesearch-controls">
      <form id="date-search-form" method="get" action="{% url_for controller='package', action='search' %}" data-module="odsh_rangesearch">
        <div class='span1'>
          <label id="rangesearch-label" class="rangesearch {% if has_range_filter %} checked {%else%} disabled {% endif %}"></label>
        </div>
        <div class='span1'>
          <div class='controls rangesearch'>
            {%- set start = request.params['ext_startdate'] -%}
            {%- set end = request.params['ext_enddate'] -%}
            {%- set typeStart = 'text' if not start else 'date' -%}
            {%- set typeEnd = 'text' if not end else 'date' -%}
            {%- set onFocus = 'onfocus=(this.type=\'date\')' -%}
            <label for="ext_startdate">{{_('from')|title}}</label>
            <input id="ext_startdate" name="ext_startdate" type="{{ typeStart }}" value="{{start}}" placeholder="{{ _('Date') }}"
              {{ onFocus }} class='rangesearch' />
            <label for="ext_enddate">{{_('to')|title}}</label>
            <input id="ext_enddate" name="ext_enddate" type="{{ typeEnd }}" value="{{end}}" placeholder="{{ _('Date') }}"
              {{ onFocus }} class='rangesearch' />
          </div>
        </div>
      </form>
    </div>
  </nav>
</section>
  {% endblock %}

</div>
{% endblock %}
{% block package_search_results_api %}
{% endblock %}
{% block page_pagination %}
{{ c.page.pager(q=c.q,symbol_next='>') }}
{% endblock %}