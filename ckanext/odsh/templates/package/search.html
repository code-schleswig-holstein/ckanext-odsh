{% ckan_extends %}

{% block toolbar %}
{{ super() }}
{% snippet "snippets/search_box.html"%}
{% endblock %}

{% block page_primary_action %}
{% endblock %}

{% block package_search_results_list %}
{{ h.snippet('snippets/package_list.html', packages=c.page.items) }}
{% endblock %}


{% block secondary_content %}
<div class="filters">
  <div class="container-fluid filter-reset">
    <div class="filter-reset-label"><span>Filter:</span></div>
    <div class="filter-reset-box"><a href="{{h.url_for(controller='package', action='search')}}">zur√ºcksetzen</a></button></div>
  </div>
</div>
{% snippet "snippets/map.html",
default_extent="{ \"type\": \"Polygon\", \"coordinates\": [[[7.6574,53.1632],[11.8322,53.1632],[11.8322,55.1066],
[7.6574,55.1066],[7.6574,53.1632]]] }"%}
<div class="filters">
  <div>
    {% for facet in c.facet_titles %}
    {{ h.snippet('snippets/facet_list.html', title=c.facet_titles[facet], name=facet) }}
    {% endfor %}
  </div>

  {% block datereange_search %}
  {% set has_range_filter = request.params.get('ext_startdate') or request.params.get('ext_enddate') %}
  <section class="module module-narrow module-shallow">
    <nav>
      <div class="nav-title">{{_('timerange')}}</div>
      <div class="rangesearch-controls">
        <form id="date-search-form" method="get" action="{% url_for controller='package', action='search' %}">
          <div class='controls rangesearch'>
            {%- set start = request.params['ext_startdate'] -%}
            {%- set start_error = h.odsh_render_datetime(start) == '' and start -%}
            {%- set end = request.params['ext_enddate'] -%}
            {%- set end_error = h.odsh_render_datetime(end) == '' and end -%}
            {%- set typeStart = 'text' if (start_error or not start) else 'date' -%}
            {%- set typeEnd = 'text' if (end_error or not end) else 'date' -%}
            {%- set onFocus = 'onfocus=(this.type=\'date\')' -%}
            <label for="ext_startdate">{{_('from')|title}}</label>
            <input id="ext_startdate" name="ext_startdate" type="{{ typeStart }}" value="{{start}}" placeholder="{{ _('Date') }}"
              {{ onFocus }} class='rangesearch' />
              {%if start_error %}
                <div class="error-reange-search">
                    {{_('wrong_start_date_for_search')}}
                </div>
              {%endif%}
            <label for="ext_enddate">{{_('to')|title}}</label>
            <input id="ext_enddate" name="ext_enddate" type="{{ typeEnd }}" value="{{end}}" placeholder="{{ _('Date') }}"
              {{ onFocus }} class='rangesearch' />
              {%if end_error %}
                <div class="error-reange-search">
                    {{_('wrong_end_date_for_search')}}
                </div>
              {%endif%}
            <a class='pull-right' href="javascript:{}" onclick="$('#date-search-form').submit();" class="action">{{_('submit date search') }}</a>
          </div>
        </form>
      </div>
    </nav>
  </section>
  {% endblock %}

</div>
{% endblock %}
{% block package_search_results_api %}
{% endblock %}
{% block page_pagination %}
{{ c.page.pager(q=c.q,symbol_next='>') }}
{% endblock %}